---
interface Filter {
  id: string;
  name: string;
}

interface Props {
  filters: Filter[];
  activeFilter?: string;
}

const { filters, activeFilter = 'all' } = Astro.props;

// Always include "All" as the first option
const allFilters = [{ id: 'all', name: 'All' }, ...filters];
---

<div class="filter-bar">
  {allFilters.map((filter) => (
    <button
      class:list={['filter-btn', { active: filter.id === activeFilter }]}
      data-filter={filter.id}
    >
      {filter.name}
    </button>
  ))}
</div>

<style>
  .filter-bar {
    display: flex;
    justify-content: center;
    gap: 0.5rem;
    margin-bottom: 2rem;
    flex-wrap: wrap;
  }

  .filter-btn {
    padding: 0.5rem 1.25rem;
    border: 1px solid #ddd;
    border-radius: 20px;
    font-size: 0.9rem;
    color: #666;
    background: transparent;
    cursor: pointer;
    transition: all 0.2s;
  }

  .filter-btn:hover {
    border-color: #1a1a1a;
    color: #1a1a1a;
  }

  .filter-btn.active {
    background: #1a1a1a;
    border-color: #1a1a1a;
    color: white;
  }
</style>

<script>
  function initFilterBar() {
    const buttons = document.querySelectorAll('.filter-btn');
    const cards = document.querySelectorAll('.photo-card[data-filter]');

    buttons.forEach((btn) => {
      btn.addEventListener('click', () => {
        const filter = btn.getAttribute('data-filter');

        // Update active button
        buttons.forEach((b) => b.classList.remove('active'));
        btn.classList.add('active');

        // Filter photos
        cards.forEach((card) => {
          const cardFilters = card.getAttribute('data-filter')?.split(',') || [];
          if (filter === 'all' || cardFilters.includes(filter!)) {
            card.classList.remove('hidden');
          } else {
            card.classList.add('hidden');
          }
        });
      });
    });
  }

  // Initialize on DOMContentLoaded
  document.addEventListener('DOMContentLoaded', initFilterBar);

  // Also initialize on Astro page transitions
  document.addEventListener('astro:page-load', initFilterBar);
</script>
