---
import PhotoLayout from '../../layouts/PhotoLayout.astro';
import { getPhotosByCategory, getCategoryBySlug } from '../../utils/config';
import type { Photo } from '../../types';

const categoryId = 'landscapes';
const category = getCategoryBySlug(categoryId);

export async function getStaticPaths() {
  const photos = getPhotosByCategory('landscapes');
  return photos.map((photo) => ({
    params: { slug: photo.slug },
    props: { photo },
  }));
}

interface Props {
  photo: Photo;
}

const { photo } = Astro.props;
const photos = getPhotosByCategory(categoryId);
const currentIndex = photos.findIndex((p) => p.slug === photo.slug);
const prevPhoto = currentIndex > 0 ? photos[currentIndex - 1] : null;
const nextPhoto = currentIndex < photos.length - 1 ? photos[currentIndex + 1] : null;
---

<PhotoLayout
  photo={photo}
  category={{ name: category?.name || 'Landscapes', slug: categoryId }}
  prevPhoto={prevPhoto}
  nextPhoto={nextPhoto}
/>
